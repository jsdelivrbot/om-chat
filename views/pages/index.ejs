<!DOCTYPE html>
<html>
<head>
  <% include ../partials/header.ejs %>
</head>

<body>

  <!--<% include ../partials/nav.ejs %>-->
  <div class="container-fluid">
    <ul id="messages"></ul>
    <form action="">
      <input id="m" autocomplete="off" /><button>Send</button>
    </form>
  </div>
<script src="/socket.io/socket.io.js"></script>
<script src="https://code.jquery.com/jquery-1.11.1.js"></script>
<script>
  $(function () {
    var socket = io();
    $('form').submit(function(){
      var loginDetails={  
          msg : $('#m').val(),  
          fb_userid : "<%=user.id%>",
          fb_username : "<%=user.displayName%>"
      };
      socket.emit('chat message', loginDetails);
      $('#m').val('');
      return false;
    });
    socket.on('chat message', function(msg){
      
        console.log(msg);
        $('#messages').append('<li><img src="https://graph.facebook.com/'+msg.fb_userid+'/picture?width=40&height=40" /> '+msg.fb_username+' ' + msg.msg);
      
    });
  });
</script>
</body>
</html>
